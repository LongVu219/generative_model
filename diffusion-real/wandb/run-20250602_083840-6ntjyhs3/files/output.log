/home/longvv/anaconda3/lib/python3.10/site-packages/torch/nn/modules/conv.py:952: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at ../aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv_transpose2d(
/home/longvv/anaconda3/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at ../aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
Epoch 0 | step 000 Loss: 1.035630464553833
Epoch 0 | step 030 Loss: 0.1311172991991043
Epoch 0 | step 060 Loss: 0.07152020931243896
Epoch 0 | step 090 Loss: 0.049455732107162476
/home/longvv/anaconda3/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at ../aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
Traceback (most recent call last):
  File "/home/longvv/generative_model/diffusion-real/train.py", line 162, in <module>
    sample_plot_image((epoch + 1)//5)
  File "/home/longvv/anaconda3/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/home/longvv/generative_model/diffusion-real/train.py", line 105, in sample_plot_image
    img = sample_timestep(img, t)
  File "/home/longvv/anaconda3/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/home/longvv/generative_model/diffusion-real/train.py", line 64, in sample_timestep
    x - betas_t * model(x, t) / sqrt_one_minus_alphas_cumprod_t
  File "/home/longvv/anaconda3/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/longvv/anaconda3/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/longvv/generative_model/diffusion-real/model.py", line 94, in forward
    x = down(x, t)
  File "/home/longvv/anaconda3/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/longvv/anaconda3/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/longvv/generative_model/diffusion-real/model.py", line 24, in forward
    h = self.bnorm1(self.relu(self.conv1(x)))
  File "/home/longvv/anaconda3/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/longvv/anaconda3/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/longvv/anaconda3/lib/python3.10/site-packages/torch/nn/modules/batchnorm.py", line 142, in forward
    self._check_input_dim(input)
  File "/home/longvv/anaconda3/lib/python3.10/site-packages/torch/nn/modules/batchnorm.py", line 425, in _check_input_dim
    raise ValueError(f"expected 4D input (got {input.dim()}D input)")
ValueError: expected 4D input (got 3D input)
